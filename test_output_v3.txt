=== RUN   TestGetRoleList_Success
{"level":"info","msg":"value8888keySERVER_PORT","time":"2025-12-09 09:49:46"}
{"level":"info","msg":"value5432keyDB_PORT","time":"2025-12-09 09:49:46"}
{"level":"info","msg":"value6379keyREDIS_PORT","time":"2025-12-09 09:49:46"}
{"level":"info","msg":"value0keyREDIS_DB","time":"2025-12-09 09:49:46"}
{"level":"info","msg":"value24keyJWT_EXPIRE_HOURS","time":"2025-12-09 09:49:46"}
{"level":"info","msg":"value72keyEXECUTION_PLAN_DEADLINE_HOURS","time":"2025-12-09 09:49:46"}
{"level":"info","msg":"Database connected successfully","time":"2025-12-09 09:49:46"}

2025/12/09 09:49:46 [32m/Users/liuyize/go/RHPRo-Task/services/PermissionService.go:14
[0m[33m[23.763ms] [34;1m[rows:7][0m SELECT * FROM "role_permissions" WHERE "role_permissions"."role_id" IN (1,2)

2025/12/09 09:49:46 [32m/Users/liuyize/go/RHPRo-Task/services/PermissionService.go:14
[0m[33m[24.662ms] [34;1m[rows:6][0m SELECT * FROM "permissions" WHERE "permissions"."id" IN (1,2,3,4,5,6) AND "permissions"."deleted_at" IS NULL

2025/12/09 09:49:46 [32m/Users/liuyize/go/RHPRo-Task/services/PermissionService.go:14
[0m[33m[93.285ms] [34;1m[rows:2][0m SELECT * FROM "roles" WHERE "roles"."deleted_at" IS NULL
--- PASS: TestGetRoleList_Success (0.17s)
=== RUN   TestGetPermissionList_Success

2025/12/09 09:49:46 [32m/Users/liuyize/go/RHPRo-Task/services/PermissionService.go:41
[0m[33m[24.255ms] [34;1m[rows:6][0m SELECT * FROM "permissions" WHERE "permissions"."deleted_at" IS NULL
--- PASS: TestGetPermissionList_Success (0.02s)
=== RUN   TestRegister_Success

2025/12/09 09:49:46 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:20
[0m[33m[24.606ms] [34;1m[rows:1][0m SELECT * FROM "users" WHERE username = 'testuser123' AND "users"."deleted_at" IS NULL ORDER BY "users"."id" LIMIT 1
--- PASS: TestRegister_Success (0.03s)
=== RUN   TestRegister_InvalidInput
--- PASS: TestRegister_InvalidInput (0.00s)
=== RUN   TestRegister_InvalidEmail
--- PASS: TestRegister_InvalidEmail (0.00s)
=== RUN   TestRegister_ShortPassword
--- PASS: TestRegister_ShortPassword (0.00s)
=== RUN   TestLogin_Success

2025/12/09 09:49:46 [31;1m/Users/liuyize/go/RHPRo-Task/services/UserService.go:66 [35;1mrecord not found
[0m[33m[11.585ms] [34;1m[rows:0][0m SELECT * FROM "users" WHERE username = 'admin' AND "users"."deleted_at" IS NULL ORDER BY "users"."id" LIMIT 1
--- PASS: TestLogin_Success (0.01s)
=== RUN   TestLogin_InvalidCredentials

2025/12/09 09:49:46 [31;1m/Users/liuyize/go/RHPRo-Task/services/UserService.go:66 [35;1mrecord not found
[0m[33m[11.085ms] [34;1m[rows:0][0m SELECT * FROM "users" WHERE username = 'nonexistentuser' AND "users"."deleted_at" IS NULL ORDER BY "users"."id" LIMIT 1
--- PASS: TestLogin_InvalidCredentials (0.01s)
=== RUN   TestLogin_EmptyCredentials
--- PASS: TestLogin_EmptyCredentials (0.00s)
=== RUN   TestCreateDepartment_Success

2025/12/09 09:49:46 [32m/Users/liuyize/go/RHPRo-Task/services/DepartmentService.go:33
[0m[33m[83.944ms] [34;1m[rows:1][0m INSERT INTO "departments" ("created_at","updated_at","deleted_at","name","description","parent_id","status") VALUES ('2025-12-09 09:49:46.679','2025-12-09 09:49:46.679',NULL,'ÊµãËØïÈÉ®Èó®','ËøôÊòØ‰∏Ä‰∏™ÊµãËØïÈÉ®Èó®',NULL,1) RETURNING "id"
--- PASS: TestCreateDepartment_Success (0.08s)
=== RUN   TestCreateDepartment_InvalidInput
--- PASS: TestCreateDepartment_InvalidInput (0.00s)
=== RUN   TestCreateDepartment_WithParent

2025/12/09 09:49:46 [31;1m/Users/liuyize/go/RHPRo-Task/services/DepartmentService.go:33 [35;1mERROR: insert or update on table "departments" violates foreign key constraint "departments_parent_id_fkey" (SQLSTATE 23503)
[0m[33m[35.011ms] [34;1m[rows:0][0m INSERT INTO "departments" ("created_at","updated_at","deleted_at","name","description","parent_id","status") VALUES ('2025-12-09 09:49:46.762','2025-12-09 09:49:46.762',NULL,'Â≠êÈÉ®Èó®','ÊµãËØïÂ≠êÈÉ®Èó®',1,1) RETURNING "id"
--- PASS: TestCreateDepartment_WithParent (0.04s)
=== RUN   TestUpdateDepartment_Success

2025/12/09 09:49:46 [31;1m/Users/liuyize/go/RHPRo-Task/services/DepartmentService.go:42 [35;1mrecord not found
[0m[33m[32.557ms] [34;1m[rows:0][0m SELECT * FROM "departments" WHERE "departments"."id" = 1 AND "departments"."deleted_at" IS NULL ORDER BY "departments"."id" LIMIT 1
--- PASS: TestUpdateDepartment_Success (0.03s)
=== RUN   TestUpdateDepartment_InvalidID
--- PASS: TestUpdateDepartment_InvalidID (0.00s)
=== RUN   TestDeleteDepartment_Success

2025/12/09 09:49:46 [32m/Users/liuyize/go/RHPRo-Task/services/DepartmentService.go:58
[0m[33m[26.801ms] [34;1m[rows:1][0m SELECT count(*) FROM "departments" WHERE parent_id = 999 AND "departments"."deleted_at" IS NULL

2025/12/09 09:49:46 [32m/Users/liuyize/go/RHPRo-Task/services/DepartmentService.go:64
[0m[33m[24.321ms] [34;1m[rows:1][0m SELECT count(*) FROM "users" WHERE department_id = 999 AND "users"."deleted_at" IS NULL

2025/12/09 09:49:46 [32m/Users/liuyize/go/RHPRo-Task/services/DepartmentService.go:69
[0m[33m[42.705ms] [34;1m[rows:0][0m UPDATE "departments" SET "deleted_at"='2025-12-09 09:49:46.882' WHERE "departments"."id" = 999 AND "departments"."deleted_at" IS NULL
--- PASS: TestDeleteDepartment_Success (0.09s)
=== RUN   TestDeleteDepartment_InvalidID
--- PASS: TestDeleteDepartment_InvalidID (0.00s)
=== RUN   TestGetDepartmentList_Success

2025/12/09 09:49:46 [32m/Users/liuyize/go/RHPRo-Task/services/DepartmentService.go:75
[0m[33m[22.275ms] [34;1m[rows:6][0m SELECT * FROM "departments" WHERE "departments"."deleted_at" IS NULL
--- PASS: TestGetDepartmentList_Success (0.02s)
=== RUN   TestGetDepartmentDetail_Success

2025/12/09 09:49:46 [31;1m/Users/liuyize/go/RHPRo-Task/services/DepartmentService.go:84 [35;1mrecord not found
[0m[33m[11.862ms] [34;1m[rows:0][0m SELECT * FROM "departments" WHERE "departments"."id" = 1 AND "departments"."deleted_at" IS NULL ORDER BY "departments"."id" LIMIT 1
--- PASS: TestGetDepartmentDetail_Success (0.01s)
=== RUN   TestGetDepartmentDetail_InvalidID
--- PASS: TestGetDepartmentDetail_InvalidID (0.00s)
=== RUN   TestAddLeader_Success

2025/12/09 09:49:46 [32m/Users/liuyize/go/RHPRo-Task/services/DepartmentService.go:117
[0m[33m[21.636ms] [34;1m[rows:1][0m SELECT count(*) FROM "department_leaders" WHERE (department_id = 1 AND user_id = 1) AND "department_leaders"."deleted_at" IS NULL

2025/12/09 09:49:47 [31;1m/Users/liuyize/go/RHPRo-Task/services/DepartmentService.go:128 [35;1mERROR: insert or update on table "department_leaders" violates foreign key constraint "department_leaders_department_id_fkey" (SQLSTATE 23503)
[0m[33m[42.809ms] [34;1m[rows:0][0m INSERT INTO "department_leaders" ("created_at","updated_at","deleted_at","department_id","user_id","is_primary","appointed_at","appointed_by") VALUES ('2025-12-09 09:49:46.982','2025-12-09 09:49:46.982',NULL,1,1,true,'0000-00-00 00:00:00',NULL) RETURNING "id"
--- PASS: TestAddLeader_Success (0.07s)
=== RUN   TestAddLeader_InvalidDeptID
--- PASS: TestAddLeader_InvalidDeptID (0.00s)
=== RUN   TestAddLeader_InvalidInput
--- PASS: TestAddLeader_InvalidInput (0.00s)
=== RUN   TestRemoveLeader_Success

2025/12/09 09:49:47 [32m/Users/liuyize/go/RHPRo-Task/services/DepartmentService.go:133
[0m[33m[52.990ms] [34;1m[rows:0][0m UPDATE "department_leaders" SET "deleted_at"='2025-12-09 09:49:47.037' WHERE (department_id = 1 AND user_id = 1) AND "department_leaders"."deleted_at" IS NULL
--- PASS: TestRemoveLeader_Success (0.05s)
=== RUN   TestRemoveLeader_InvalidDeptID
--- PASS: TestRemoveLeader_InvalidDeptID (0.00s)
=== RUN   TestRemoveLeader_InvalidUserID
--- PASS: TestRemoveLeader_InvalidUserID (0.00s)
=== RUN   TestAssignUsers_Success

2025/12/09 09:49:47 [31;1m/Users/liuyize/go/RHPRo-Task/services/DepartmentService.go:138 [35;1mERROR: insert or update on table "users" violates foreign key constraint "users_department_id_fkey" (SQLSTATE 23503)
[0m[33m[45.897ms] [34;1m[rows:0][0m UPDATE "users" SET "department_id"=1,"updated_at"='2025-12-09 09:49:47.081' WHERE id IN (1,2,3) AND "users"."deleted_at" IS NULL
--- PASS: TestAssignUsers_Success (0.05s)
=== RUN   TestAssignUsers_InvalidDeptID
--- PASS: TestAssignUsers_InvalidDeptID (0.00s)
=== RUN   TestAssignUsers_EmptyList

2025/12/09 09:49:47 [32m/Users/liuyize/go/RHPRo-Task/services/DepartmentService.go:138
[0m[33m[43.691ms] [34;1m[rows:0][0m UPDATE "users" SET "department_id"=1,"updated_at"='2025-12-09 09:49:47.127' WHERE id IN (NULL) AND "users"."deleted_at" IS NULL
--- PASS: TestAssignUsers_EmptyList (0.04s)
=== RUN   TestCreateTask_Success

2025/12/09 09:49:47 [32m/Users/liuyize/go/RHPRo-Task/services/TaskService.go:19
[0m[33m[25.524ms] [34;1m[rows:1][0m SELECT * FROM "tasks" WHERE task_no = 'TASK-TEST-001' AND "tasks"."deleted_at" IS NULL ORDER BY "tasks"."id" LIMIT 1
--- PASS: TestCreateTask_Success (0.03s)
=== RUN   TestCreateTask_InvalidInput
--- PASS: TestCreateTask_InvalidInput (0.00s)
=== RUN   TestCreateTask_WithExecutor

2025/12/09 09:49:47 [32m/Users/liuyize/go/RHPRo-Task/services/TaskService.go:19
[0m[33m[10.982ms] [34;1m[rows:1][0m SELECT * FROM "tasks" WHERE task_no = 'TASK-TEST-002' AND "tasks"."deleted_at" IS NULL ORDER BY "tasks"."id" LIMIT 1
--- PASS: TestCreateTask_WithExecutor (0.01s)
=== RUN   TestGetTaskList_Success

2025/12/09 09:49:47 [32m/Users/liuyize/go/RHPRo-Task/services/TaskService.go:130
[0m[33m[24.684ms] [34;1m[rows:1][0m SELECT count(*) FROM "tasks" WHERE "tasks"."deleted_at" IS NULL

2025/12/09 09:49:47 [32m/Users/liuyize/go/RHPRo-Task/services/TaskService.go:141
[0m[33m[22.699ms] [34;1m[rows:3][0m SELECT * FROM "tasks" WHERE "tasks"."deleted_at" IS NULL ORDER BY created_at DESC LIMIT 10
--- PASS: TestGetTaskList_Success (0.05s)
=== RUN   TestGetTaskList_WithFilters

2025/12/09 09:49:47 [32m/Users/liuyize/go/RHPRo-Task/services/TaskService.go:130
[0m[33m[22.384ms] [34;1m[rows:1][0m SELECT count(*) FROM "tasks" WHERE task_type_code = 'requirement' AND priority = 1 AND "tasks"."deleted_at" IS NULL

2025/12/09 09:49:47 [32m/Users/liuyize/go/RHPRo-Task/services/TaskService.go:141
[0m[33m[23.479ms] [34;1m[rows:2][0m SELECT * FROM "tasks" WHERE task_type_code = 'requirement' AND priority = 1 AND "tasks"."deleted_at" IS NULL ORDER BY created_at DESC LIMIT 10
--- PASS: TestGetTaskList_WithFilters (0.05s)
=== RUN   TestGetTaskList_ByStatus

2025/12/09 09:49:47 [32m/Users/liuyize/go/RHPRo-Task/services/TaskService.go:130
[0m[33m[21.994ms] [34;1m[rows:1][0m SELECT count(*) FROM "tasks" WHERE status_code = 'draft' AND "tasks"."deleted_at" IS NULL

2025/12/09 09:49:47 [32m/Users/liuyize/go/RHPRo-Task/services/TaskService.go:141
[0m[33m[24.702ms] [34;1m[rows:1][0m SELECT * FROM "tasks" WHERE status_code = 'draft' AND "tasks"."deleted_at" IS NULL ORDER BY created_at DESC LIMIT 10
--- PASS: TestGetTaskList_ByStatus (0.05s)
=== RUN   TestGetTaskByID_Success

2025/12/09 09:49:47 [31;1m/Users/liuyize/go/RHPRo-Task/services/TaskService.go:293 [35;1mrecord not found
[0m[33m[22.610ms] [34;1m[rows:0][0m SELECT * FROM "tasks" WHERE "tasks"."id" = 1 AND "tasks"."deleted_at" IS NULL ORDER BY "tasks"."id" LIMIT 1
--- PASS: TestGetTaskByID_Success (0.02s)
=== RUN   TestGetTaskByID_InvalidID
--- PASS: TestGetTaskByID_InvalidID (0.00s)
=== RUN   TestGetTaskByID_NotFound

2025/12/09 09:49:47 [31;1m/Users/liuyize/go/RHPRo-Task/services/TaskService.go:293 [35;1mrecord not found
[0m[33m[12.043ms] [34;1m[rows:0][0m SELECT * FROM "tasks" WHERE "tasks"."id" = 999999 AND "tasks"."deleted_at" IS NULL ORDER BY "tasks"."id" LIMIT 1
--- PASS: TestGetTaskByID_NotFound (0.01s)
=== RUN   TestUpdateTask_Success

2025/12/09 09:49:47 [32m/Users/liuyize/go/RHPRo-Task/services/TaskService.go:364
[0m[33m[12.062ms] [34;1m[rows:1][0m SELECT * FROM "tasks" WHERE "tasks"."id" = 11 AND "tasks"."deleted_at" IS NULL ORDER BY "tasks"."id" LIMIT 1

2025/12/09 09:49:47 [32m/Users/liuyize/go/RHPRo-Task/services/TaskService.go:481
[0m[33m[22.766ms] [34;1m[rows:1][0m UPDATE "tasks" SET "description"='Êõ¥Êñ∞ÂêéÁöÑÊèèËø∞',"priority"=3,"title"='Êõ¥Êñ∞ÂêéÁöÑÊ†áÈ¢ò',"updated_at"='2025-12-09 09:49:47.402' WHERE "tasks"."deleted_at" IS NULL AND "id" = 11

2025/12/09 09:49:47 [32m/Users/liuyize/go/RHPRo-Task/services/TaskService.go:488
[0m[33m[25.943ms] [34;1m[rows:3][0m INSERT INTO "task_change_logs" ("created_at","task_id","user_id","change_type","field_name","old_value","new_value","comment") VALUES ('2025-12-09 09:49:47.425',11,1,'field_update','title','ÊµãËØï‰ªªÂä°','Êõ¥Êñ∞ÂêéÁöÑÊ†áÈ¢ò','Êõ¥Êñ∞Ê†áÈ¢ò'),('2025-12-09 09:49:47.425',11,1,'field_update','description','ËøôÊòØ‰∏Ä‰∏™ÊµãËØï‰ªªÂä°','Êõ¥Êñ∞ÂêéÁöÑÊèèËø∞','Êõ¥Êñ∞ÊèèËø∞'),('2025-12-09 09:49:47.425',11,1,'field_update','priority','1','3','Êõ¥Êñ∞‰ºòÂÖàÁ∫ß') RETURNING "id"
--- PASS: TestUpdateTask_Success (0.09s)
=== RUN   TestUpdateTask_InvalidID
--- PASS: TestUpdateTask_InvalidID (0.00s)
=== RUN   TestDeleteTask_Success

2025/12/09 09:49:47 [31;1m/Users/liuyize/go/RHPRo-Task/services/TaskService.go:538 [35;1mrecord not found
[0m[33m[11.443ms] [34;1m[rows:0][0m SELECT * FROM "tasks" WHERE "tasks"."id" = 999 AND "tasks"."deleted_at" IS NULL ORDER BY "tasks"."id" LIMIT 1
--- PASS: TestDeleteTask_Success (0.01s)
=== RUN   TestDeleteTask_InvalidID
--- PASS: TestDeleteTask_InvalidID (0.00s)
=== RUN   TestTransitStatus_Success

2025/12/09 09:49:47 [31;1m/Users/liuyize/go/RHPRo-Task/services/TaskService.go:563 [35;1mrecord not found
[0m[33m[10.785ms] [34;1m[rows:0][0m SELECT * FROM "tasks" WHERE "tasks"."id" = 1 AND "tasks"."deleted_at" IS NULL ORDER BY "tasks"."id" LIMIT 1
--- PASS: TestTransitStatus_Success (0.01s)
=== RUN   TestTransitStatus_InvalidID
--- PASS: TestTransitStatus_InvalidID (0.00s)
=== RUN   TestTransitStatus_InvalidInput
--- PASS: TestTransitStatus_InvalidInput (0.00s)
=== RUN   TestAssignExecutor_Success

2025/12/09 09:49:47 [31;1m/Users/liuyize/go/RHPRo-Task/services/TaskService.go:640 [35;1mrecord not found
[0m[33m[12.216ms] [34;1m[rows:0][0m SELECT * FROM "tasks" WHERE "tasks"."id" = 1 AND "tasks"."deleted_at" IS NULL ORDER BY "tasks"."id" LIMIT 1
--- PASS: TestAssignExecutor_Success (0.01s)
=== RUN   TestAssignExecutor_InvalidID
--- PASS: TestAssignExecutor_InvalidID (0.00s)
=== RUN   TestAssignExecutor_InvalidInput
--- PASS: TestAssignExecutor_InvalidInput (0.00s)
=== RUN   TestAcceptTask_Success

2025/12/09 09:49:47 [31;1m/Users/liuyize/go/RHPRo-Task/services/TaskFlowService.go:24 [35;1mrecord not found
[0m[33m[13.078ms] [34;1m[rows:0][0m SELECT * FROM "tasks" WHERE "tasks"."id" = 1 AND "tasks"."deleted_at" IS NULL ORDER BY "tasks"."id" LIMIT 1
--- PASS: TestAcceptTask_Success (0.01s)
=== RUN   TestAcceptTask_InvalidID
--- PASS: TestAcceptTask_InvalidID (0.00s)
=== RUN   TestRejectTask_Success

2025/12/09 09:49:47 [31;1m/Users/liuyize/go/RHPRo-Task/services/TaskFlowService.go:92 [35;1mrecord not found
[0m[33m[11.755ms] [34;1m[rows:0][0m SELECT * FROM "tasks" WHERE "tasks"."id" = 1 AND "tasks"."deleted_at" IS NULL ORDER BY "tasks"."id" LIMIT 1
--- PASS: TestRejectTask_Success (0.01s)
=== RUN   TestRejectTask_InvalidInput
--- PASS: TestRejectTask_InvalidInput (0.00s)
=== RUN   TestRejectTask_InvalidID
--- PASS: TestRejectTask_InvalidID (0.00s)
=== RUN   TestSubmitGoals_Success

2025/12/09 09:49:47 [31;1m/Users/liuyize/go/RHPRo-Task/services/TaskFlowService.go:166 [35;1mrecord not found
[0m[33m[11.850ms] [34;1m[rows:0][0m SELECT * FROM "tasks" WHERE "tasks"."id" = 1 AND "tasks"."deleted_at" IS NULL ORDER BY "tasks"."id" LIMIT 1
--- PASS: TestSubmitGoals_Success (0.01s)
=== RUN   TestSubmitGoals_InvalidInput
--- PASS: TestSubmitGoals_InvalidInput (0.00s)
=== RUN   TestSubmitGoals_InvalidID
--- PASS: TestSubmitGoals_InvalidID (0.00s)
=== RUN   TestInitiateReview_Success

2025/12/09 09:49:47 [31;1m/Users/liuyize/go/RHPRo-Task/services/TaskFlowService.go:280 [35;1mrecord not found
[0m[33m[11.456ms] [34;1m[rows:0][0m SELECT * FROM "tasks" WHERE "tasks"."id" = 1 AND "tasks"."deleted_at" IS NULL ORDER BY "tasks"."id" LIMIT 1
--- PASS: TestInitiateReview_Success (0.01s)
=== RUN   TestInitiateReview_JuryMode

2025/12/09 09:49:47 [31;1m/Users/liuyize/go/RHPRo-Task/services/TaskFlowService.go:280 [35;1mrecord not found
[0m[33m[12.638ms] [34;1m[rows:0][0m SELECT * FROM "tasks" WHERE "tasks"."id" = 1 AND "tasks"."deleted_at" IS NULL ORDER BY "tasks"."id" LIMIT 1
--- PASS: TestInitiateReview_JuryMode (0.01s)
=== RUN   TestInitiateReview_InvalidInput
--- PASS: TestInitiateReview_InvalidInput (0.00s)
=== RUN   TestSubmitExecutionPlan_Success

2025/12/09 09:49:47 [31;1m/Users/liuyize/go/RHPRo-Task/services/TaskFlowService.go:694 [35;1mrecord not found
[0m[33m[15.274ms] [34;1m[rows:0][0m SELECT * FROM "tasks" WHERE "tasks"."id" = 1 AND "tasks"."deleted_at" IS NULL ORDER BY "tasks"."id" LIMIT 1
--- PASS: TestSubmitExecutionPlan_Success (0.02s)
=== RUN   TestSubmitExecutionPlan_InvalidInput
--- PASS: TestSubmitExecutionPlan_InvalidInput (0.00s)
=== RUN   TestGetReviewSession_Success

2025/12/09 09:49:47 [31;1m/Users/liuyize/go/RHPRo-Task/services/TaskFlowService.go:511 [35;1mrecord not found
[0m[33m[25.007ms] [34;1m[rows:0][0m SELECT * FROM "review_sessions" WHERE "review_sessions"."id" = 1 AND "review_sessions"."deleted_at" IS NULL ORDER BY "review_sessions"."id" LIMIT 1
--- PASS: TestGetReviewSession_Success (0.03s)
=== RUN   TestGetReviewSession_InvalidID
--- PASS: TestGetReviewSession_InvalidID (0.00s)
=== RUN   TestSubmitReviewOpinion_Success

2025/12/09 09:49:47 [31;1m/Users/liuyize/go/RHPRo-Task/services/TaskFlowService.go:366 [35;1mrecord not found
[0m[33m[12.414ms] [34;1m[rows:0][0m SELECT * FROM "review_sessions" WHERE "review_sessions"."id" = 1 AND "review_sessions"."deleted_at" IS NULL ORDER BY "review_sessions"."id" LIMIT 1
--- PASS: TestSubmitReviewOpinion_Success (0.01s)
=== RUN   TestSubmitReviewOpinion_Reject

2025/12/09 09:49:47 [31;1m/Users/liuyize/go/RHPRo-Task/services/TaskFlowService.go:366 [35;1mrecord not found
[0m[33m[11.096ms] [34;1m[rows:0][0m SELECT * FROM "review_sessions" WHERE "review_sessions"."id" = 1 AND "review_sessions"."deleted_at" IS NULL ORDER BY "review_sessions"."id" LIMIT 1
--- PASS: TestSubmitReviewOpinion_Reject (0.01s)
=== RUN   TestSubmitReviewOpinion_InvalidInput
--- PASS: TestSubmitReviewOpinion_InvalidInput (0.00s)
=== RUN   TestFinalizeReview_Approve

2025/12/09 09:49:47 [31;1m/Users/liuyize/go/RHPRo-Task/services/TaskFlowService.go:413 [35;1mrecord not found
[0m[33m[11.750ms] [34;1m[rows:0][0m SELECT * FROM "review_sessions" WHERE "review_sessions"."id" = 1 AND "review_sessions"."deleted_at" IS NULL ORDER BY "review_sessions"."id" LIMIT 1
--- PASS: TestFinalizeReview_Approve (0.01s)
=== RUN   TestFinalizeReview_Reject

2025/12/09 09:49:47 [31;1m/Users/liuyize/go/RHPRo-Task/services/TaskFlowService.go:413 [35;1mrecord not found
[0m[33m[12.384ms] [34;1m[rows:0][0m SELECT * FROM "review_sessions" WHERE "review_sessions"."id" = 1 AND "review_sessions"."deleted_at" IS NULL ORDER BY "review_sessions"."id" LIMIT 1
--- PASS: TestFinalizeReview_Reject (0.01s)
=== RUN   TestFinalizeReview_InvalidID
--- PASS: TestFinalizeReview_InvalidID (0.00s)
=== RUN   TestInviteJury_Success

2025/12/09 09:49:47 [31;1m/Users/liuyize/go/RHPRo-Task/services/TaskFlowService.go:556 [35;1mrecord not found
[0m[33m[12.578ms] [34;1m[rows:0][0m SELECT * FROM "review_sessions" WHERE "review_sessions"."id" = 1 AND "review_sessions"."deleted_at" IS NULL ORDER BY "review_sessions"."id" LIMIT 1
--- PASS: TestInviteJury_Success (0.01s)
=== RUN   TestInviteJury_InvalidInput
--- PASS: TestInviteJury_InvalidInput (0.00s)
=== RUN   TestInviteJury_InvalidID
--- PASS: TestInviteJury_InvalidID (0.00s)
=== RUN   TestRemoveJuryMember_Success

2025/12/09 09:49:47 [31;1m/Users/liuyize/go/RHPRo-Task/services/TaskFlowService.go:640 [35;1mrecord not found
[0m[33m[10.614ms] [34;1m[rows:0][0m SELECT * FROM "review_sessions" WHERE "review_sessions"."id" = 1 AND "review_sessions"."deleted_at" IS NULL ORDER BY "review_sessions"."id" LIMIT 1
--- PASS: TestRemoveJuryMember_Success (0.01s)
=== RUN   TestRemoveJuryMember_InvalidSessionID
--- PASS: TestRemoveJuryMember_InvalidSessionID (0.00s)
=== RUN   TestRemoveJuryMember_InvalidMemberID
--- PASS: TestRemoveJuryMember_InvalidMemberID (0.00s)
=== RUN   TestGetProfile_Success

2025/12/09 09:49:47 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:163
[0m[33m[21.535ms] [34;1m[rows:0][0m SELECT * FROM "department_leaders" WHERE "department_leaders"."user_id" = 1

2025/12/09 09:49:47 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:163
[0m[33m[25.196ms] [34;1m[rows:2][0m SELECT * FROM "user_roles" WHERE "user_roles"."user_id" = 1

2025/12/09 09:49:47 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:163
[0m[33m[28.347ms] [34;1m[rows:2][0m SELECT * FROM "roles" WHERE "roles"."id" IN (1,2) AND "roles"."deleted_at" IS NULL

2025/12/09 09:49:47 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:163
[0m[33m[96.850ms] [34;1m[rows:1][0m SELECT * FROM "users" WHERE "users"."id" = 1 AND "users"."deleted_at" IS NULL ORDER BY "users"."id" LIMIT 1
--- PASS: TestGetProfile_Success (0.10s)
=== RUN   TestGetUserList_Success

2025/12/09 09:49:47 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:214
[0m[33m[24.949ms] [34;1m[rows:1][0m SELECT count(*) FROM "users" WHERE "users"."deleted_at" IS NULL

2025/12/09 09:49:47 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:217
[0m[33m[21.398ms] [34;1m[rows:0][0m SELECT * FROM "department_leaders" WHERE "department_leaders"."user_id" IN (9,11,1)

2025/12/09 09:49:47 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:217
[0m[33m[22.157ms] [34;1m[rows:4][0m SELECT * FROM "user_roles" WHERE "user_roles"."user_id" IN (9,11,1)

2025/12/09 09:49:47 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:217
[0m[33m[11.638ms] [34;1m[rows:2][0m SELECT * FROM "roles" WHERE "roles"."id" IN (2,1) AND "roles"."deleted_at" IS NULL

2025/12/09 09:49:47 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:217
[0m[33m[79.173ms] [34;1m[rows:3][0m SELECT * FROM "users" WHERE "users"."deleted_at" IS NULL LIMIT 10
--- PASS: TestGetUserList_Success (0.10s)
=== RUN   TestGetUserList_WithPagination

2025/12/09 09:49:47 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:214
[0m[33m[10.283ms] [34;1m[rows:1][0m SELECT count(*) FROM "users" WHERE "users"."deleted_at" IS NULL

2025/12/09 09:49:47 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:217
[0m[33m[22.744ms] [34;1m[rows:0][0m SELECT * FROM "users" WHERE "users"."deleted_at" IS NULL LIMIT 5 OFFSET 5
--- PASS: TestGetUserList_WithPagination (0.03s)
=== RUN   TestGetUserByID_Success

2025/12/09 09:49:47 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:163
[0m[33m[10.600ms] [34;1m[rows:0][0m SELECT * FROM "department_leaders" WHERE "department_leaders"."user_id" = 1

2025/12/09 09:49:47 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:163
[0m[33m[10.639ms] [34;1m[rows:2][0m SELECT * FROM "user_roles" WHERE "user_roles"."user_id" = 1

2025/12/09 09:49:47 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:163
[0m[33m[10.858ms] [34;1m[rows:2][0m SELECT * FROM "roles" WHERE "roles"."id" IN (1,2) AND "roles"."deleted_at" IS NULL

2025/12/09 09:49:47 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:163
[0m[33m[43.345ms] [34;1m[rows:1][0m SELECT * FROM "users" WHERE "users"."id" = 1 AND "users"."deleted_at" IS NULL ORDER BY "users"."id" LIMIT 1
--- PASS: TestGetUserByID_Success (0.04s)
=== RUN   TestGetUserByID_InvalidID
--- PASS: TestGetUserByID_InvalidID (0.00s)
=== RUN   TestGetUserByID_NotFound

2025/12/09 09:49:47 [31;1m/Users/liuyize/go/RHPRo-Task/services/UserService.go:163 [35;1mrecord not found
[0m[33m[10.772ms] [34;1m[rows:0][0m SELECT * FROM "users" WHERE "users"."id" = 999999 AND "users"."deleted_at" IS NULL ORDER BY "users"."id" LIMIT 1
--- PASS: TestGetUserByID_NotFound (0.01s)
=== RUN   TestUpdateUser_Success

2025/12/09 09:49:47 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:271
[0m[33m[10.453ms] [34;1m[rows:1][0m SELECT * FROM "users" WHERE "users"."id" = 1 AND "users"."deleted_at" IS NULL ORDER BY "users"."id" LIMIT 1

2025/12/09 09:49:48 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:307
[0m[33m[45.722ms] [34;1m[rows:1][0m UPDATE "users" SET "created_at"='2025-12-08 19:37:25.617',"updated_at"='2025-12-09 09:49:47.999',"deleted_at"=NULL,"username"='Liuyz',"nickname"='Updated Nickname',"email"='printflyz@gmail.com',"password"='$2a$10$Z9rfsbAcSVVOnSdKnmeS1uyI3uOknU2Qwe8/bujjJ7BiAf06INwYK',"mobile"='13426306041',"department_id"=NULL,"status"=1 WHERE "users"."deleted_at" IS NULL AND "id" = 1
--- PASS: TestUpdateUser_Success (0.06s)
=== RUN   TestUpdateUser_InvalidID
--- PASS: TestUpdateUser_InvalidID (0.00s)
=== RUN   TestCreateUser_Success

2025/12/09 09:49:48 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:332
[0m[33m[11.161ms] [34;1m[rows:1][0m SELECT * FROM "users" WHERE username = 'newuser123' AND "users"."deleted_at" IS NULL ORDER BY "users"."id" LIMIT 1
--- PASS: TestCreateUser_Success (0.01s)
=== RUN   TestCreateUser_InvalidInput
--- PASS: TestCreateUser_InvalidInput (0.00s)
=== RUN   TestAssignRoles_Success

2025/12/09 09:49:48 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:313
[0m[33m[11.813ms] [34;1m[rows:1][0m SELECT * FROM "users" WHERE "users"."id" = 1 AND "users"."deleted_at" IS NULL ORDER BY "users"."id" LIMIT 1

2025/12/09 09:49:48 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:318
[0m[33m[11.204ms] [34;1m[rows:2][0m SELECT * FROM "roles" WHERE "roles"."id" IN (1,2) AND "roles"."deleted_at" IS NULL

2025/12/09 09:49:48 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:323
[0m[33m[44.853ms] [34;1m[rows:2][0m DELETE FROM "user_roles" WHERE "user_roles"."user_id" = 1

2025/12/09 09:49:48 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:324
[0m[33m[22.873ms] [34;1m[rows:0][0m INSERT INTO "roles" ("created_at","updated_at","deleted_at","name","description","id") VALUES ('2025-12-01 14:26:21.139','2025-12-01 14:26:21.139',NULL,'admin','ÁÆ°ÁêÜÂëò',1),('2025-12-01 14:26:21.139','2025-12-01 14:26:21.139',NULL,'user','ÊôÆÈÄöÁî®Êà∑',2) ON CONFLICT DO NOTHING RETURNING "id"

2025/12/09 09:49:48 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:324
[0m[33m[22.735ms] [34;1m[rows:2][0m INSERT INTO "user_roles" ("user_id","role_id") VALUES (1,1),(1,2) ON CONFLICT DO NOTHING

2025/12/09 09:49:48 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:324
[0m[33m[92.284ms] [34;1m[rows:1][0m UPDATE "users" SET "updated_at"='2025-12-09 09:49:48.127' WHERE "users"."deleted_at" IS NULL AND "id" = 1
--- PASS: TestAssignRoles_Success (0.16s)
=== RUN   TestAssignRoles_InvalidID
--- PASS: TestAssignRoles_InvalidID (0.00s)
=== RUN   TestAssignRoles_EmptyRoles
--- PASS: TestAssignRoles_EmptyRoles (0.00s)
=== RUN   TestApproveUser_Success

2025/12/09 09:49:48 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:373
[0m[33m[11.816ms] [34;1m[rows:1][0m SELECT * FROM "users" WHERE "users"."id" = 1 AND "users"."deleted_at" IS NULL ORDER BY "users"."id" LIMIT 1
--- PASS: TestApproveUser_Success (0.01s)
=== RUN   TestApproveUser_InvalidID
--- PASS: TestApproveUser_InvalidID (0.00s)
PASS
ok  	RHPRo-Task/controllers	3.272s
