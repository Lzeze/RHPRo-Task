=== RUN   TestGetRoleList_Success
{"level":"info","msg":"value8888keySERVER_PORT","time":"2025-12-09 09:43:30"}
{"level":"info","msg":"value5432keyDB_PORT","time":"2025-12-09 09:43:30"}
{"level":"info","msg":"value6379keyREDIS_PORT","time":"2025-12-09 09:43:30"}
{"level":"info","msg":"value0keyREDIS_DB","time":"2025-12-09 09:43:30"}
{"level":"info","msg":"value24keyJWT_EXPIRE_HOURS","time":"2025-12-09 09:43:30"}
{"level":"info","msg":"value72keyEXECUTION_PLAN_DEADLINE_HOURS","time":"2025-12-09 09:43:30"}
{"level":"info","msg":"Database connected successfully","time":"2025-12-09 09:43:30"}

2025/12/09 09:43:30 [32m/Users/liuyize/go/RHPRo-Task/services/PermissionService.go:14
[0m[33m[24.733ms] [34;1m[rows:7][0m SELECT * FROM "role_permissions" WHERE "role_permissions"."role_id" IN (1,2)

2025/12/09 09:43:30 [32m/Users/liuyize/go/RHPRo-Task/services/PermissionService.go:14
[0m[33m[23.331ms] [34;1m[rows:6][0m SELECT * FROM "permissions" WHERE "permissions"."id" IN (1,2,3,4,5,6) AND "permissions"."deleted_at" IS NULL

2025/12/09 09:43:30 [32m/Users/liuyize/go/RHPRo-Task/services/PermissionService.go:14
[0m[33m[93.035ms] [34;1m[rows:2][0m SELECT * FROM "roles" WHERE "roles"."deleted_at" IS NULL
--- PASS: TestGetRoleList_Success (0.17s)
=== RUN   TestGetPermissionList_Success

2025/12/09 09:43:30 [32m/Users/liuyize/go/RHPRo-Task/services/PermissionService.go:41
[0m[33m[23.339ms] [34;1m[rows:6][0m SELECT * FROM "permissions" WHERE "permissions"."deleted_at" IS NULL
--- PASS: TestGetPermissionList_Success (0.02s)
=== RUN   TestRegister_Success

2025/12/09 09:43:30 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:20
[0m[33m[24.567ms] [34;1m[rows:1][0m SELECT * FROM "users" WHERE username = 'testuser123' AND "users"."deleted_at" IS NULL ORDER BY "users"."id" LIMIT 1
--- PASS: TestRegister_Success (0.03s)
=== RUN   TestRegister_InvalidInput
--- PASS: TestRegister_InvalidInput (0.00s)
=== RUN   TestRegister_InvalidEmail
--- PASS: TestRegister_InvalidEmail (0.00s)
=== RUN   TestRegister_ShortPassword
--- PASS: TestRegister_ShortPassword (0.00s)
=== RUN   TestLogin_Success

2025/12/09 09:43:31 [31;1m/Users/liuyize/go/RHPRo-Task/services/UserService.go:66 [35;1mrecord not found
[0m[33m[11.457ms] [34;1m[rows:0][0m SELECT * FROM "users" WHERE username = 'admin' AND "users"."deleted_at" IS NULL ORDER BY "users"."id" LIMIT 1
--- PASS: TestLogin_Success (0.01s)
=== RUN   TestLogin_InvalidCredentials

2025/12/09 09:43:31 [31;1m/Users/liuyize/go/RHPRo-Task/services/UserService.go:66 [35;1mrecord not found
[0m[33m[13.830ms] [34;1m[rows:0][0m SELECT * FROM "users" WHERE username = 'nonexistentuser' AND "users"."deleted_at" IS NULL ORDER BY "users"."id" LIMIT 1
--- PASS: TestLogin_InvalidCredentials (0.01s)
=== RUN   TestLogin_EmptyCredentials
--- PASS: TestLogin_EmptyCredentials (0.00s)
=== RUN   TestCreateDepartment_Success

2025/12/09 09:43:31 [32m/Users/liuyize/go/RHPRo-Task/services/DepartmentService.go:33
[0m[33m[80.347ms] [34;1m[rows:1][0m INSERT INTO "departments" ("created_at","updated_at","deleted_at","name","description","parent_id","status") VALUES ('2025-12-09 09:43:31.034','2025-12-09 09:43:31.034',NULL,'ÊµãËØïÈÉ®Èó®','ËøôÊòØ‰∏Ä‰∏™ÊµãËØïÈÉ®Èó®',NULL,1) RETURNING "id"
--- PASS: TestCreateDepartment_Success (0.08s)
=== RUN   TestCreateDepartment_InvalidInput
--- PASS: TestCreateDepartment_InvalidInput (0.00s)
=== RUN   TestCreateDepartment_WithParent

2025/12/09 09:43:31 [31;1m/Users/liuyize/go/RHPRo-Task/services/DepartmentService.go:33 [35;1mERROR: insert or update on table "departments" violates foreign key constraint "departments_parent_id_fkey" (SQLSTATE 23503)
[0m[33m[34.946ms] [34;1m[rows:0][0m INSERT INTO "departments" ("created_at","updated_at","deleted_at","name","description","parent_id","status") VALUES ('2025-12-09 09:43:31.111','2025-12-09 09:43:31.111',NULL,'Â≠êÈÉ®Èó®','ÊµãËØïÂ≠êÈÉ®Èó®',1,1) RETURNING "id"
--- PASS: TestCreateDepartment_WithParent (0.04s)
=== RUN   TestUpdateDepartment_Success

2025/12/09 09:43:31 [31;1m/Users/liuyize/go/RHPRo-Task/services/DepartmentService.go:42 [35;1mrecord not found
[0m[33m[32.449ms] [34;1m[rows:0][0m SELECT * FROM "departments" WHERE "departments"."id" = 1 AND "departments"."deleted_at" IS NULL ORDER BY "departments"."id" LIMIT 1
--- PASS: TestUpdateDepartment_Success (0.03s)
=== RUN   TestUpdateDepartment_InvalidID
--- PASS: TestUpdateDepartment_InvalidID (0.00s)
=== RUN   TestDeleteDepartment_Success

2025/12/09 09:43:31 [32m/Users/liuyize/go/RHPRo-Task/services/DepartmentService.go:58
[0m[33m[22.477ms] [34;1m[rows:1][0m SELECT count(*) FROM "departments" WHERE parent_id = 999 AND "departments"."deleted_at" IS NULL

2025/12/09 09:43:31 [32m/Users/liuyize/go/RHPRo-Task/services/DepartmentService.go:64
[0m[33m[33.097ms] [34;1m[rows:1][0m SELECT count(*) FROM "users" WHERE department_id = 999 AND "users"."deleted_at" IS NULL

2025/12/09 09:43:31 [32m/Users/liuyize/go/RHPRo-Task/services/DepartmentService.go:69
[0m[33m[47.544ms] [34;1m[rows:0][0m UPDATE "departments" SET "deleted_at"='2025-12-09 09:43:31.235' WHERE "departments"."id" = 999 AND "departments"."deleted_at" IS NULL
--- PASS: TestDeleteDepartment_Success (0.10s)
=== RUN   TestDeleteDepartment_InvalidID
--- PASS: TestDeleteDepartment_InvalidID (0.00s)
=== RUN   TestGetDepartmentList_Success

2025/12/09 09:43:31 [32m/Users/liuyize/go/RHPRo-Task/services/DepartmentService.go:75
[0m[33m[21.644ms] [34;1m[rows:5][0m SELECT * FROM "departments" WHERE "departments"."deleted_at" IS NULL
--- PASS: TestGetDepartmentList_Success (0.02s)
=== RUN   TestGetDepartmentDetail_Success

2025/12/09 09:43:31 [31;1m/Users/liuyize/go/RHPRo-Task/services/DepartmentService.go:84 [35;1mrecord not found
[0m[33m[11.416ms] [34;1m[rows:0][0m SELECT * FROM "departments" WHERE "departments"."id" = 1 AND "departments"."deleted_at" IS NULL ORDER BY "departments"."id" LIMIT 1
--- PASS: TestGetDepartmentDetail_Success (0.01s)
=== RUN   TestGetDepartmentDetail_InvalidID
--- PASS: TestGetDepartmentDetail_InvalidID (0.00s)
=== RUN   TestAddLeader_Success

2025/12/09 09:43:31 [32m/Users/liuyize/go/RHPRo-Task/services/DepartmentService.go:117
[0m[33m[27.678ms] [34;1m[rows:1][0m SELECT count(*) FROM "department_leaders" WHERE (department_id = 1 AND user_id = 1) AND "department_leaders"."deleted_at" IS NULL

2025/12/09 09:43:31 [31;1m/Users/liuyize/go/RHPRo-Task/services/DepartmentService.go:128 [35;1mERROR: insert or update on table "department_leaders" violates foreign key constraint "department_leaders_department_id_fkey" (SQLSTATE 23503)
[0m[33m[47.646ms] [34;1m[rows:0][0m INSERT INTO "department_leaders" ("created_at","updated_at","deleted_at","department_id","user_id","is_primary","appointed_at","appointed_by") VALUES ('2025-12-09 09:43:31.349','2025-12-09 09:43:31.349',NULL,1,1,true,'0000-00-00 00:00:00',NULL) RETURNING "id"
--- PASS: TestAddLeader_Success (0.08s)
=== RUN   TestAddLeader_InvalidDeptID
--- PASS: TestAddLeader_InvalidDeptID (0.00s)
=== RUN   TestAddLeader_InvalidInput
--- PASS: TestAddLeader_InvalidInput (0.00s)
=== RUN   TestRemoveLeader_Success

2025/12/09 09:43:31 [32m/Users/liuyize/go/RHPRo-Task/services/DepartmentService.go:133
[0m[33m[55.567ms] [34;1m[rows:0][0m UPDATE "department_leaders" SET "deleted_at"='2025-12-09 09:43:31.404' WHERE (department_id = 1 AND user_id = 1) AND "department_leaders"."deleted_at" IS NULL
--- PASS: TestRemoveLeader_Success (0.06s)
=== RUN   TestRemoveLeader_InvalidDeptID
--- PASS: TestRemoveLeader_InvalidDeptID (0.00s)
=== RUN   TestRemoveLeader_InvalidUserID
--- PASS: TestRemoveLeader_InvalidUserID (0.00s)
=== RUN   TestAssignUsers_Success

2025/12/09 09:43:31 [31;1m/Users/liuyize/go/RHPRo-Task/services/DepartmentService.go:138 [35;1mERROR: insert or update on table "users" violates foreign key constraint "users_department_id_fkey" (SQLSTATE 23503)
[0m[33m[45.037ms] [34;1m[rows:0][0m UPDATE "users" SET "department_id"=1,"updated_at"='2025-12-09 09:43:31.45' WHERE id IN (1,2,3) AND "users"."deleted_at" IS NULL
--- PASS: TestAssignUsers_Success (0.05s)
=== RUN   TestAssignUsers_InvalidDeptID
--- PASS: TestAssignUsers_InvalidDeptID (0.00s)
=== RUN   TestAssignUsers_EmptyList

2025/12/09 09:43:31 [32m/Users/liuyize/go/RHPRo-Task/services/DepartmentService.go:138
[0m[33m[44.654ms] [34;1m[rows:0][0m UPDATE "users" SET "department_id"=1,"updated_at"='2025-12-09 09:43:31.495' WHERE id IN (NULL) AND "users"."deleted_at" IS NULL
--- PASS: TestAssignUsers_EmptyList (0.04s)
=== RUN   TestCreateTask_Success

2025/12/09 09:43:31 [32m/Users/liuyize/go/RHPRo-Task/services/TaskService.go:19
[0m[33m[24.011ms] [34;1m[rows:1][0m SELECT * FROM "tasks" WHERE task_no = 'TASK-TEST-001' AND "tasks"."deleted_at" IS NULL ORDER BY "tasks"."id" LIMIT 1
--- PASS: TestCreateTask_Success (0.02s)
=== RUN   TestCreateTask_InvalidInput
--- PASS: TestCreateTask_InvalidInput (0.00s)
=== RUN   TestCreateTask_WithExecutor

2025/12/09 09:43:31 [32m/Users/liuyize/go/RHPRo-Task/services/TaskService.go:19
[0m[33m[12.074ms] [34;1m[rows:1][0m SELECT * FROM "tasks" WHERE task_no = 'TASK-TEST-002' AND "tasks"."deleted_at" IS NULL ORDER BY "tasks"."id" LIMIT 1
--- PASS: TestCreateTask_WithExecutor (0.01s)
=== RUN   TestGetTaskList_Success

2025/12/09 09:43:31 [32m/Users/liuyize/go/RHPRo-Task/services/TaskService.go:130
[0m[33m[22.141ms] [34;1m[rows:1][0m SELECT count(*) FROM "tasks" WHERE "tasks"."deleted_at" IS NULL

2025/12/09 09:43:31 [32m/Users/liuyize/go/RHPRo-Task/services/TaskService.go:141
[0m[33m[25.803ms] [34;1m[rows:3][0m SELECT * FROM "tasks" WHERE "tasks"."deleted_at" IS NULL ORDER BY created_at DESC LIMIT 10
--- PASS: TestGetTaskList_Success (0.05s)
=== RUN   TestGetTaskList_WithFilters

2025/12/09 09:43:31 [32m/Users/liuyize/go/RHPRo-Task/services/TaskService.go:130
[0m[33m[151.832ms] [34;1m[rows:1][0m SELECT count(*) FROM "tasks" WHERE task_type_code = 'requirement' AND priority = 1 AND "tasks"."deleted_at" IS NULL

2025/12/09 09:43:31 [32m/Users/liuyize/go/RHPRo-Task/services/TaskService.go:141
[0m[33m[23.244ms] [34;1m[rows:2][0m SELECT * FROM "tasks" WHERE task_type_code = 'requirement' AND priority = 1 AND "tasks"."deleted_at" IS NULL ORDER BY created_at DESC LIMIT 10
--- PASS: TestGetTaskList_WithFilters (0.18s)
=== RUN   TestGetTaskList_ByStatus

2025/12/09 09:43:31 [32m/Users/liuyize/go/RHPRo-Task/services/TaskService.go:130
[0m[33m[23.144ms] [34;1m[rows:1][0m SELECT count(*) FROM "tasks" WHERE status_code = 'draft' AND "tasks"."deleted_at" IS NULL

2025/12/09 09:43:31 [32m/Users/liuyize/go/RHPRo-Task/services/TaskService.go:141
[0m[33m[22.421ms] [34;1m[rows:1][0m SELECT * FROM "tasks" WHERE status_code = 'draft' AND "tasks"."deleted_at" IS NULL ORDER BY created_at DESC LIMIT 10
--- PASS: TestGetTaskList_ByStatus (0.05s)
=== RUN   TestGetTaskByID_Success

2025/12/09 09:43:31 [31;1m/Users/liuyize/go/RHPRo-Task/services/TaskService.go:293 [35;1mrecord not found
[0m[33m[21.835ms] [34;1m[rows:0][0m SELECT * FROM "tasks" WHERE "tasks"."id" = 1 AND "tasks"."deleted_at" IS NULL ORDER BY "tasks"."id" LIMIT 1
--- PASS: TestGetTaskByID_Success (0.02s)
=== RUN   TestGetTaskByID_InvalidID
--- PASS: TestGetTaskByID_InvalidID (0.00s)
=== RUN   TestGetTaskByID_NotFound

2025/12/09 09:43:31 [31;1m/Users/liuyize/go/RHPRo-Task/services/TaskService.go:293 [35;1mrecord not found
[0m[33m[10.449ms] [34;1m[rows:0][0m SELECT * FROM "tasks" WHERE "tasks"."id" = 999999 AND "tasks"."deleted_at" IS NULL ORDER BY "tasks"."id" LIMIT 1
--- PASS: TestGetTaskByID_NotFound (0.01s)
=== RUN   TestUpdateTask_Success

2025/12/09 09:43:31 [32m/Users/liuyize/go/RHPRo-Task/services/TaskService.go:364
[0m[33m[11.344ms] [34;1m[rows:1][0m SELECT * FROM "tasks" WHERE "tasks"."id" = 11 AND "tasks"."deleted_at" IS NULL ORDER BY "tasks"."id" LIMIT 1

2025/12/09 09:43:31 [32m/Users/liuyize/go/RHPRo-Task/services/TaskService.go:481
[0m[33m[35.772ms] [34;1m[rows:1][0m UPDATE "tasks" SET "description"='Êõ¥Êñ∞ÂêéÁöÑÊèèËø∞',"priority"=3,"title"='Êõ¥Êñ∞ÂêéÁöÑÊ†áÈ¢ò',"updated_at"='2025-12-09 09:43:31.894' WHERE "tasks"."deleted_at" IS NULL AND "id" = 11

2025/12/09 09:43:31 [31;1m/Users/liuyize/go/RHPRo-Task/services/TaskService.go:488 [35;1mERROR: column "updated_at" of relation "task_change_logs" does not exist (SQLSTATE 42703)
[0m[33m[12.882ms] [34;1m[rows:0][0m INSERT INTO "task_change_logs" ("created_at","updated_at","deleted_at","task_id","user_id","change_type","field_name","old_value","new_value","comment") VALUES ('2025-12-09 09:43:31.93','2025-12-09 09:43:31.93',NULL,11,1,'field_update','title','ÊµãËØï‰ªªÂä°','Êõ¥Êñ∞ÂêéÁöÑÊ†áÈ¢ò','Êõ¥Êñ∞Ê†áÈ¢ò'),('2025-12-09 09:43:31.93','2025-12-09 09:43:31.93',NULL,11,1,'field_update','description','ËøôÊòØ‰∏Ä‰∏™ÊµãËØï‰ªªÂä°','Êõ¥Êñ∞ÂêéÁöÑÊèèËø∞','Êõ¥Êñ∞ÊèèËø∞'),('2025-12-09 09:43:31.93','2025-12-09 09:43:31.93',NULL,11,1,'field_update','priority','1','3','Êõ¥Êñ∞‰ºòÂÖàÁ∫ß') RETURNING "id"
    task_controller_test.go:173: 
        	Error Trace:	/Users/liuyize/go/RHPRo-Task/controllers/task_controller_test.go:173
        	Error:      	Should be true
        	Test:       	TestUpdateTask_Success
--- FAIL: TestUpdateTask_Success (0.08s)
=== RUN   TestUpdateTask_InvalidID
--- PASS: TestUpdateTask_InvalidID (0.00s)
=== RUN   TestDeleteTask_Success

2025/12/09 09:43:31 [31;1m/Users/liuyize/go/RHPRo-Task/services/TaskService.go:538 [35;1mrecord not found
[0m[33m[11.111ms] [34;1m[rows:0][0m SELECT * FROM "tasks" WHERE "tasks"."id" = 999 AND "tasks"."deleted_at" IS NULL ORDER BY "tasks"."id" LIMIT 1
--- PASS: TestDeleteTask_Success (0.01s)
=== RUN   TestDeleteTask_InvalidID
--- PASS: TestDeleteTask_InvalidID (0.00s)
=== RUN   TestTransitStatus_Success

2025/12/09 09:43:31 [31;1m/Users/liuyize/go/RHPRo-Task/services/TaskService.go:563 [35;1mrecord not found
[0m[33m[12.448ms] [34;1m[rows:0][0m SELECT * FROM "tasks" WHERE "tasks"."id" = 1 AND "tasks"."deleted_at" IS NULL ORDER BY "tasks"."id" LIMIT 1
--- PASS: TestTransitStatus_Success (0.01s)
=== RUN   TestTransitStatus_InvalidID
--- PASS: TestTransitStatus_InvalidID (0.00s)
=== RUN   TestTransitStatus_InvalidInput
--- PASS: TestTransitStatus_InvalidInput (0.00s)
=== RUN   TestAssignExecutor_Success

2025/12/09 09:43:31 [31;1m/Users/liuyize/go/RHPRo-Task/services/TaskService.go:640 [35;1mrecord not found
[0m[33m[11.979ms] [34;1m[rows:0][0m SELECT * FROM "tasks" WHERE "tasks"."id" = 1 AND "tasks"."deleted_at" IS NULL ORDER BY "tasks"."id" LIMIT 1
--- PASS: TestAssignExecutor_Success (0.01s)
=== RUN   TestAssignExecutor_InvalidID
--- PASS: TestAssignExecutor_InvalidID (0.00s)
=== RUN   TestAssignExecutor_InvalidInput
--- PASS: TestAssignExecutor_InvalidInput (0.00s)
=== RUN   TestAcceptTask_Success

2025/12/09 09:43:32 [31;1m/Users/liuyize/go/RHPRo-Task/services/TaskFlowService.go:24 [35;1mrecord not found
[0m[33m[11.391ms] [34;1m[rows:0][0m SELECT * FROM "tasks" WHERE "tasks"."id" = 1 AND "tasks"."deleted_at" IS NULL ORDER BY "tasks"."id" LIMIT 1
--- PASS: TestAcceptTask_Success (0.01s)
=== RUN   TestAcceptTask_InvalidID
--- PASS: TestAcceptTask_InvalidID (0.00s)
=== RUN   TestRejectTask_Success

2025/12/09 09:43:32 [31;1m/Users/liuyize/go/RHPRo-Task/services/TaskFlowService.go:92 [35;1mrecord not found
[0m[33m[10.528ms] [34;1m[rows:0][0m SELECT * FROM "tasks" WHERE "tasks"."id" = 1 AND "tasks"."deleted_at" IS NULL ORDER BY "tasks"."id" LIMIT 1
--- PASS: TestRejectTask_Success (0.01s)
=== RUN   TestRejectTask_InvalidInput
--- PASS: TestRejectTask_InvalidInput (0.00s)
=== RUN   TestRejectTask_InvalidID
--- PASS: TestRejectTask_InvalidID (0.00s)
=== RUN   TestSubmitGoals_Success

2025/12/09 09:43:32 [31;1m/Users/liuyize/go/RHPRo-Task/services/TaskFlowService.go:166 [35;1mrecord not found
[0m[33m[11.208ms] [34;1m[rows:0][0m SELECT * FROM "tasks" WHERE "tasks"."id" = 1 AND "tasks"."deleted_at" IS NULL ORDER BY "tasks"."id" LIMIT 1
--- PASS: TestSubmitGoals_Success (0.01s)
=== RUN   TestSubmitGoals_InvalidInput
--- PASS: TestSubmitGoals_InvalidInput (0.00s)
=== RUN   TestSubmitGoals_InvalidID
--- PASS: TestSubmitGoals_InvalidID (0.00s)
=== RUN   TestInitiateReview_Success

2025/12/09 09:43:32 [31;1m/Users/liuyize/go/RHPRo-Task/services/TaskFlowService.go:280 [35;1mrecord not found
[0m[33m[12.541ms] [34;1m[rows:0][0m SELECT * FROM "tasks" WHERE "tasks"."id" = 1 AND "tasks"."deleted_at" IS NULL ORDER BY "tasks"."id" LIMIT 1
--- PASS: TestInitiateReview_Success (0.01s)
=== RUN   TestInitiateReview_JuryMode

2025/12/09 09:43:32 [31;1m/Users/liuyize/go/RHPRo-Task/services/TaskFlowService.go:280 [35;1mrecord not found
[0m[33m[11.359ms] [34;1m[rows:0][0m SELECT * FROM "tasks" WHERE "tasks"."id" = 1 AND "tasks"."deleted_at" IS NULL ORDER BY "tasks"."id" LIMIT 1
--- PASS: TestInitiateReview_JuryMode (0.01s)
=== RUN   TestInitiateReview_InvalidInput
--- PASS: TestInitiateReview_InvalidInput (0.00s)
=== RUN   TestSubmitExecutionPlan_Success

2025/12/09 09:43:32 [31;1m/Users/liuyize/go/RHPRo-Task/services/TaskFlowService.go:694 [35;1mrecord not found
[0m[33m[11.372ms] [34;1m[rows:0][0m SELECT * FROM "tasks" WHERE "tasks"."id" = 1 AND "tasks"."deleted_at" IS NULL ORDER BY "tasks"."id" LIMIT 1
--- PASS: TestSubmitExecutionPlan_Success (0.01s)
=== RUN   TestSubmitExecutionPlan_InvalidInput
--- PASS: TestSubmitExecutionPlan_InvalidInput (0.00s)
=== RUN   TestGetReviewSession_Success

2025/12/09 09:43:32 [31;1m/Users/liuyize/go/RHPRo-Task/services/TaskFlowService.go:511 [35;1mrecord not found
[0m[33m[23.949ms] [34;1m[rows:0][0m SELECT * FROM "review_sessions" WHERE "review_sessions"."id" = 1 AND "review_sessions"."deleted_at" IS NULL ORDER BY "review_sessions"."id" LIMIT 1
--- PASS: TestGetReviewSession_Success (0.02s)
=== RUN   TestGetReviewSession_InvalidID
--- PASS: TestGetReviewSession_InvalidID (0.00s)
=== RUN   TestSubmitReviewOpinion_Success

2025/12/09 09:43:32 [31;1m/Users/liuyize/go/RHPRo-Task/services/TaskFlowService.go:366 [35;1mrecord not found
[0m[33m[11.367ms] [34;1m[rows:0][0m SELECT * FROM "review_sessions" WHERE "review_sessions"."id" = 1 AND "review_sessions"."deleted_at" IS NULL ORDER BY "review_sessions"."id" LIMIT 1
--- PASS: TestSubmitReviewOpinion_Success (0.01s)
=== RUN   TestSubmitReviewOpinion_Reject

2025/12/09 09:43:32 [31;1m/Users/liuyize/go/RHPRo-Task/services/TaskFlowService.go:366 [35;1mrecord not found
[0m[33m[14.492ms] [34;1m[rows:0][0m SELECT * FROM "review_sessions" WHERE "review_sessions"."id" = 1 AND "review_sessions"."deleted_at" IS NULL ORDER BY "review_sessions"."id" LIMIT 1
--- PASS: TestSubmitReviewOpinion_Reject (0.01s)
=== RUN   TestSubmitReviewOpinion_InvalidInput
--- PASS: TestSubmitReviewOpinion_InvalidInput (0.00s)
=== RUN   TestFinalizeReview_Approve

2025/12/09 09:43:32 [31;1m/Users/liuyize/go/RHPRo-Task/services/TaskFlowService.go:413 [35;1mrecord not found
[0m[33m[11.036ms] [34;1m[rows:0][0m SELECT * FROM "review_sessions" WHERE "review_sessions"."id" = 1 AND "review_sessions"."deleted_at" IS NULL ORDER BY "review_sessions"."id" LIMIT 1
--- PASS: TestFinalizeReview_Approve (0.01s)
=== RUN   TestFinalizeReview_Reject

2025/12/09 09:43:32 [31;1m/Users/liuyize/go/RHPRo-Task/services/TaskFlowService.go:413 [35;1mrecord not found
[0m[33m[10.913ms] [34;1m[rows:0][0m SELECT * FROM "review_sessions" WHERE "review_sessions"."id" = 1 AND "review_sessions"."deleted_at" IS NULL ORDER BY "review_sessions"."id" LIMIT 1
--- PASS: TestFinalizeReview_Reject (0.01s)
=== RUN   TestFinalizeReview_InvalidID
--- PASS: TestFinalizeReview_InvalidID (0.00s)
=== RUN   TestInviteJury_Success

2025/12/09 09:43:32 [31;1m/Users/liuyize/go/RHPRo-Task/services/TaskFlowService.go:556 [35;1mrecord not found
[0m[33m[11.863ms] [34;1m[rows:0][0m SELECT * FROM "review_sessions" WHERE "review_sessions"."id" = 1 AND "review_sessions"."deleted_at" IS NULL ORDER BY "review_sessions"."id" LIMIT 1
--- PASS: TestInviteJury_Success (0.01s)
=== RUN   TestInviteJury_InvalidInput
--- PASS: TestInviteJury_InvalidInput (0.00s)
=== RUN   TestInviteJury_InvalidID
--- PASS: TestInviteJury_InvalidID (0.00s)
=== RUN   TestRemoveJuryMember_Success

2025/12/09 09:43:32 [31;1m/Users/liuyize/go/RHPRo-Task/services/TaskFlowService.go:640 [35;1mrecord not found
[0m[33m[12.277ms] [34;1m[rows:0][0m SELECT * FROM "review_sessions" WHERE "review_sessions"."id" = 1 AND "review_sessions"."deleted_at" IS NULL ORDER BY "review_sessions"."id" LIMIT 1
--- PASS: TestRemoveJuryMember_Success (0.01s)
=== RUN   TestRemoveJuryMember_InvalidSessionID
--- PASS: TestRemoveJuryMember_InvalidSessionID (0.00s)
=== RUN   TestRemoveJuryMember_InvalidMemberID
--- PASS: TestRemoveJuryMember_InvalidMemberID (0.00s)
=== RUN   TestGetProfile_Success

2025/12/09 09:43:32 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:163
[0m[33m[21.561ms] [34;1m[rows:0][0m SELECT * FROM "department_leaders" WHERE "department_leaders"."user_id" = 1

2025/12/09 09:43:32 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:163
[0m[33m[23.336ms] [34;1m[rows:2][0m SELECT * FROM "user_roles" WHERE "user_roles"."user_id" = 1

2025/12/09 09:43:32 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:163
[0m[33m[27.161ms] [34;1m[rows:2][0m SELECT * FROM "roles" WHERE "roles"."id" IN (1,2) AND "roles"."deleted_at" IS NULL

2025/12/09 09:43:32 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:163
[0m[33m[96.793ms] [34;1m[rows:1][0m SELECT * FROM "users" WHERE "users"."id" = 1 AND "users"."deleted_at" IS NULL ORDER BY "users"."id" LIMIT 1
--- PASS: TestGetProfile_Success (0.10s)
=== RUN   TestGetUserList_Success

2025/12/09 09:43:32 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:214
[0m[33m[24.718ms] [34;1m[rows:1][0m SELECT count(*) FROM "users" WHERE "users"."deleted_at" IS NULL

2025/12/09 09:43:32 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:217
[0m[33m[23.435ms] [34;1m[rows:0][0m SELECT * FROM "department_leaders" WHERE "department_leaders"."user_id" IN (9,11,1)

2025/12/09 09:43:32 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:217
[0m[33m[25.620ms] [34;1m[rows:4][0m SELECT * FROM "user_roles" WHERE "user_roles"."user_id" IN (9,11,1)

2025/12/09 09:43:32 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:217
[0m[33m[11.720ms] [34;1m[rows:2][0m SELECT * FROM "roles" WHERE "roles"."id" IN (2,1) AND "roles"."deleted_at" IS NULL

2025/12/09 09:43:32 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:217
[0m[33m[87.691ms] [34;1m[rows:3][0m SELECT * FROM "users" WHERE "users"."deleted_at" IS NULL LIMIT 10
--- PASS: TestGetUserList_Success (0.11s)
=== RUN   TestGetUserList_WithPagination

2025/12/09 09:43:32 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:214
[0m[33m[12.141ms] [34;1m[rows:1][0m SELECT count(*) FROM "users" WHERE "users"."deleted_at" IS NULL

2025/12/09 09:43:32 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:217
[0m[33m[27.913ms] [34;1m[rows:0][0m SELECT * FROM "users" WHERE "users"."deleted_at" IS NULL LIMIT 5 OFFSET 5
--- PASS: TestGetUserList_WithPagination (0.04s)
=== RUN   TestGetUserByID_Success

2025/12/09 09:43:32 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:163
[0m[33m[11.453ms] [34;1m[rows:0][0m SELECT * FROM "department_leaders" WHERE "department_leaders"."user_id" = 1

2025/12/09 09:43:32 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:163
[0m[33m[11.780ms] [34;1m[rows:2][0m SELECT * FROM "user_roles" WHERE "user_roles"."user_id" = 1

2025/12/09 09:43:32 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:163
[0m[33m[11.575ms] [34;1m[rows:2][0m SELECT * FROM "roles" WHERE "roles"."id" IN (1,2) AND "roles"."deleted_at" IS NULL

2025/12/09 09:43:32 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:163
[0m[33m[46.721ms] [34;1m[rows:1][0m SELECT * FROM "users" WHERE "users"."id" = 1 AND "users"."deleted_at" IS NULL ORDER BY "users"."id" LIMIT 1
--- PASS: TestGetUserByID_Success (0.05s)
=== RUN   TestGetUserByID_InvalidID
--- PASS: TestGetUserByID_InvalidID (0.00s)
=== RUN   TestGetUserByID_NotFound

2025/12/09 09:43:32 [31;1m/Users/liuyize/go/RHPRo-Task/services/UserService.go:163 [35;1mrecord not found
[0m[33m[11.337ms] [34;1m[rows:0][0m SELECT * FROM "users" WHERE "users"."id" = 999999 AND "users"."deleted_at" IS NULL ORDER BY "users"."id" LIMIT 1
--- PASS: TestGetUserByID_NotFound (0.01s)
=== RUN   TestUpdateUser_Success

2025/12/09 09:43:32 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:271
[0m[33m[11.384ms] [34;1m[rows:1][0m SELECT * FROM "users" WHERE "users"."id" = 1 AND "users"."deleted_at" IS NULL ORDER BY "users"."id" LIMIT 1

2025/12/09 09:43:32 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:307
[0m[33m[49.527ms] [34;1m[rows:1][0m UPDATE "users" SET "created_at"='2025-12-08 19:37:25.617',"updated_at"='2025-12-09 09:43:32.496',"deleted_at"=NULL,"username"='Liuyz',"nickname"='Updated Nickname',"email"='printflyz@gmail.com',"password"='$2a$10$Z9rfsbAcSVVOnSdKnmeS1uyI3uOknU2Qwe8/bujjJ7BiAf06INwYK',"mobile"='13426306041',"department_id"=NULL,"status"=1 WHERE "users"."deleted_at" IS NULL AND "id" = 1
--- PASS: TestUpdateUser_Success (0.06s)
=== RUN   TestUpdateUser_InvalidID
--- PASS: TestUpdateUser_InvalidID (0.00s)
=== RUN   TestCreateUser_Success

2025/12/09 09:43:32 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:332
[0m[33m[12.052ms] [34;1m[rows:1][0m SELECT * FROM "users" WHERE username = 'newuser123' AND "users"."deleted_at" IS NULL ORDER BY "users"."id" LIMIT 1
--- PASS: TestCreateUser_Success (0.01s)
=== RUN   TestCreateUser_InvalidInput
--- PASS: TestCreateUser_InvalidInput (0.00s)
=== RUN   TestAssignRoles_Success

2025/12/09 09:43:32 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:313
[0m[33m[11.738ms] [34;1m[rows:1][0m SELECT * FROM "users" WHERE "users"."id" = 1 AND "users"."deleted_at" IS NULL ORDER BY "users"."id" LIMIT 1

2025/12/09 09:43:32 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:318
[0m[33m[12.232ms] [34;1m[rows:2][0m SELECT * FROM "roles" WHERE "roles"."id" IN (1,2) AND "roles"."deleted_at" IS NULL

2025/12/09 09:43:32 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:323
[0m[33m[48.235ms] [34;1m[rows:2][0m DELETE FROM "user_roles" WHERE "user_roles"."user_id" = 1

2025/12/09 09:43:32 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:324
[0m[33m[23.081ms] [34;1m[rows:0][0m INSERT INTO "roles" ("created_at","updated_at","deleted_at","name","description","id") VALUES ('2025-12-01 14:26:21.139','2025-12-01 14:26:21.139',NULL,'admin','ÁÆ°ÁêÜÂëò',1),('2025-12-01 14:26:21.139','2025-12-01 14:26:21.139',NULL,'user','ÊôÆÈÄöÁî®Êà∑',2) ON CONFLICT DO NOTHING RETURNING "id"

2025/12/09 09:43:32 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:324
[0m[33m[23.494ms] [34;1m[rows:2][0m INSERT INTO "user_roles" ("user_id","role_id") VALUES (1,1),(1,2) ON CONFLICT DO NOTHING

2025/12/09 09:43:32 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:324
[0m[33m[94.539ms] [34;1m[rows:1][0m UPDATE "users" SET "updated_at"='2025-12-09 09:43:32.632' WHERE "users"."deleted_at" IS NULL AND "id" = 1
--- PASS: TestAssignRoles_Success (0.17s)
=== RUN   TestAssignRoles_InvalidID
--- PASS: TestAssignRoles_InvalidID (0.00s)
=== RUN   TestAssignRoles_EmptyRoles
--- PASS: TestAssignRoles_EmptyRoles (0.00s)
=== RUN   TestApproveUser_Success

2025/12/09 09:43:32 [32m/Users/liuyize/go/RHPRo-Task/services/UserService.go:373
[0m[33m[11.949ms] [34;1m[rows:1][0m SELECT * FROM "users" WHERE "users"."id" = 1 AND "users"."deleted_at" IS NULL ORDER BY "users"."id" LIMIT 1
--- PASS: TestApproveUser_Success (0.01s)
=== RUN   TestApproveUser_InvalidID
--- PASS: TestApproveUser_InvalidID (0.00s)
FAIL
FAIL	RHPRo-Task/controllers	3.439s
FAIL
